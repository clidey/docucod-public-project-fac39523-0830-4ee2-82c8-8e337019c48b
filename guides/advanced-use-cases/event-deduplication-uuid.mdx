---
title: "Event Deduplication with UUIDs"
description: "Explore advanced event deduplication strategies using UUIDs to ensure high event integrity in distributed or idempotent scenarios. Includes recommended packages and example implementations."
---

# Event Deduplication with UUIDs

## Overview
This guide helps you implement advanced event deduplication strategies in PostHog Go using UUIDs. It addresses how to ensure high event integrity by preventing duplicate event ingestion, especially in distributed or retry-prone environments. Using UUIDs for each event enables reliable identification and filtering of repeated events, preserving data accuracy.


## Who Should Use This Guide
This page is designed for backend developers and analytics engineers integrating PostHog Go into applications where events may be retried, batched, or sent asynchronously. If you need to guarantee that your event data is unique and not duplicated due to client retries, network failures, or distributed systems, this guide provides actionable approaches.


## What You Will Achieve
- Understand the concept and necessity of event deduplication with UUIDs.
- Learn how to attach UUIDs to events when capturing them.
- Handle event batches containing UUIDs.
- Prevent ingestion and processing of duplicated events.


## Estimated Time
10-20 minutes, depending on familiarity with event capture and batching


---

## Step-by-Step Instructions

### 1. Understand the Role of UUIDs in Event Deduplication
Each event sent to PostHog can include a `uuid` field — a unique identifier for that event instance. When you assign a UUID to each event, PostHog can detect duplicates by matching on this identifier.

The benefit of this approach is clear in scenarios where:
- Events are batched and sent multiple times due to retries
- Distributed clients emit identical events
- Idempotency is required to ensure single event recording


### 2. Capture Events with UUIDs
When creating an event capture call, generate and assign a UUID to the event’s `uuid` field. For example, a single event data payload looks like this:

```json
{
  "api_key": "Csyjlnlun3OzyNJAafdlv",
  "batch": [
    {
      "distinct_id": "123456",
      "event": "Download",
      "library": "posthog-go",
      "library_version": "1.0.0",
      "properties": {
        "$geoip_disable": true,
        "$lib": "posthog-go",
        "$lib_version": "1.0.0",
        "application": "PostHog Go",
        "platform": "macos",
        "version": "1.0.0"
      },
      "send_feature_flags": false,
      "timestamp": "2009-11-10T23:00:00Z",
      "type": "capture",
      "uuid": "11111111-1111-1111-1111-111111111111"
    }
  ]
}
```

Notice the `uuid` field at the event level holding a UUID string. This UUID must be unique for each logically distinct event.


### 3. Generate UUIDs in Your Application
How you generate UUIDs depends on your technology stack. In Go, you can generate UUIDs using libraries like `github.com/google/uuid`:

```go
import "github.com/google/uuid"

func generateEventUUID() string {
    return uuid.New().String() // Produces a string like "11111111-1111-1111-1111-111111111111"
}
```

Use this function when constructing your event before sending it.


### 4. Batch Events with UUIDs
When sending multiple events in a batch, assign each event a unique UUID. The batch structure supports multiple distinct events, each with its own UUID:

```json
{
  "api_key": "Csyjlnlun3OzyNJAafdlv",
  "batch": [
    {
      "distinct_id": "123456",
      "event": "Download",
      "library": "posthog-go",
      "library_version": "1.0.0",
      "properties": {
        "$geoip_disable": true,
        "$lib": "posthog-go",
        "$lib_version": "1.0.0",
        "application": "PostHog Go",
        "version": 0
      },
      "send_feature_flags": false,
      "timestamp": "2009-11-10T23:00:00Z",
      "type": "capture",
      "uuid": "aaaaaaa1-1111-1111-1111-111111111111"
    },
    {
      "distinct_id": "123456",
      "event": "Download",
      "library": "posthog-go",
      "library_version": "1.0.0",
      "properties": {
        "$geoip_disable": true,
        "$lib": "posthog-go",
        "$lib_version": "1.0.0",
        "application": "PostHog Go",
        "version": 1
      },
      "send_feature_flags": false,
      "timestamp": "2009-11-10T23:00:00Z",
      "type": "capture",
      "uuid": "bbbbbbb2-2222-2222-2222-222222222222"
    },
    {
      "distinct_id": "123456",
      "event": "Download",
      "library": "posthog-go",
      "library_version": "1.0.0",
      "properties": {
        "$geoip_disable": true,
        "$lib": "posthog-go",
        "$lib_version": "1.0.0",
        "application": "PostHog Go",
        "version": 2
      },
      "send_feature_flags": false,
      "timestamp": "2009-11-10T23:00:00Z",
      "type": "capture",
      "uuid": "ccccccc3-3333-3333-3333-333333333333"
    }
  ]
}
```

This ensures that if this batch is retried, the PostHog backend can identify and discard duplicates.


### 5. Best Practices for Using UUIDs
- **Always generate UUIDs client-side for all events you want deduplicated.**
- Use **version 4 UUIDs (random)** for best uniqueness guarantees.
- Avoid sending empty or blank `uuid` fields if you want deduplication to work.
- If events have no UUID, they will be processed normally without deduplication.


### 6. What Happens When You Send Events Without UUIDs?
Events without the `uuid` field or with empty UUIDs will not be deduplicated by PostHog. This means duplicate events can be recorded if sent multiple times. Examples of such event payloads show an empty string in the `uuid` field:

```json
{
  "uuid": ""
}
```

To leverage deduplication, ensure your integration always assigns UUIDs.


### 7. Verifying Deduplication
Once events with UUIDs are ingested, PostHog will store them uniquely by their UUID across all projects. Duplicate incoming events with the same UUID will be ignored.

You can confirm deduplication by:
- Monitoring your event counts.
- Checking if retried duplicate events vanish on the PostHog dashboard.


---

## Troubleshooting & Tips

### Common Issues
- **Duplicate events still appear:** Check if your events include valid, distinct UUIDs.
- **UUIDs are missing or empty:** Update your code to generate and assign UUIDs before sending.
- **UUID collisions:** Highly unlikely with proper UUID generation but use standard libraries to avoid issues.


### Tips
- Use UUIDs even if events are unique at source to safeguard against network retries.
- Use consistent UUID generation logic when retrying to keep the same UUID.
- Batch events with UUIDs to reduce network overhead while maintaining deduplication integrity.


---

## Summary
By using UUIDs in your PostHog Go event captures, you enforce strong deduplication guarantees for your analytics data. This ensures that repeated submissions of the same event will not inflate your metrics or distort analytics.

Implementing UUID-based deduplication strengthens the reliability of event data in environments with retries, distributed clients, or asynchronous batching.


---

## Next Steps & Related Content
- [Capturing Events Guide](/guides/core-workflows/capturing-events) - Learn basic event capturing workflows.
- [Integrating with the PostHog Platform](/overview/features-and-integration/integration-with-posthog) - Understand overall integration techniques.
- [User Identification & Aliasing](/guides/core-workflows/user-identification-aliasing) - Manage user identities alongside event capture.
- [Performance Optimization](/guides/advanced-use-cases/performance-optimization) - Optimize your PostHog Go usage.


---

## Additional Resources
- PostHog Go GitHub Repository: [https://github.com/PostHog/posthog-go](https://github.com/PostHog/posthog-go)
- UUID Package for Go: [https://github.com/google/uuid](https://github.com/google/uuid)





